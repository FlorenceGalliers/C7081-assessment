---
title: "Can we predict house prices using known features of each house and a supervised learning approach?"
author: "Florence Galliers"
date: "18/10/2020"
output: pdf_document
---
```{r set wd / libraries / reading in data, include = FALSE}
setwd("~/Google Drive/Harper/1-C7081/Asssesment/github-C7081/C7081-assessment")

library(knitr)
library(ggplot2)

data <- read.csv(file = "original-data.csv")
```

## Background:
House prices are an important part of the economy...
Motivate the story...
What do we already know?
What lessons will the story teach us?

When purchasing a house people are more likely to look only at the number of bedrooms and number of bathrooms, rather than the square foot of the house. This may be because they do not understand how square foot is calculated, or find it difficult to visualise how this translates into the house size. 

### Objectives:
- Understand which independent variables in the data set can be used to predict house price (the dependent variable)
- Minimize the differences between predicted and actual house prices by using model selection to choose the most accurate model.

## Data:
The data for this analysis contains house prices and information regarding the features of each house. It has 4600 entries. The original data set downloaded from Kaggle had 17 independent variables, however I felt that 7 of these were not relevant to this analysis and so they have been removed. The dependent variable in this analysis will be the house price (in US dollars). 

This data is from houses sold in 2014 in Washington, USA. However it is an interesting data set that contains a large amount of information and number of variables. I was not able to find a similar data set from the UK, and so I am going to go ahead with this data set as I feel it will produce some interesting results.

### Data Preparation:
- There was originally a variable called sqft_basement which gave the size of the basement if present, 
however a lot of houses did not have basement so I felt it would be more useful to turn this variable from numeric 
into binary. It now shows 0 = no basement, 1 = basement. 
- I also changed the variable year_renovated into a binary variable, as again, not all the houses had been renovated. 0 = not renovated, 1 = renovated.
- Check if there are any zero values for the price variable as these are not acceptable in a housing price situation, a house cannot cost nothing, so we must remove these and assume they are errors in the data set.
- Remove outliers

```{r, echo = FALSE}
# removing unwanted variables from original kaggle dataset
variables_to_remove <- c(1, 8, 9, 11, 15, 17, 18)
data <- data[ ,-variables_to_remove]

# changing variable sqft_basement into binary variable basement
data$sqft_basement <- ifelse(data$sqft_basement == 0, 0, 1)
# change column name from sqft_basement to if_basement
names(data)[names(data) =="sqft_basement"] <- "if_basement"

# changing yr_renovated into binary variable renovates
data$yr_renovated <- ifelse(data$yr_renovated == 0, 0, 1)
# change column name from yr_renovated to if_renovated
names(data)[names(data) =="yr_renovated"] <- "if_renovated"

# look if any values are = 0, assign them to variable
zero_values <- which(data$price == 0)
# remove these from the data set as house price cannot = 0
data <- data[-zero_values,]
# we are now left with 4551 observations

#convert yr_built variable into age
end_year <- 2014 #year data is from
#calculate age of each house is years
data$yr_built <- end_year - data$yr_built
#change column name from yr_built to house_age
names(data)[names(data)=="yr_built"] <- "house_age"

#convert price variable into thousands of dollars
data$price <- data$price/1000

# remove outliers
outliers <- c(100, 2387, 2921)
data <- data[-outliers, ]

# data2 now contains all variables except from city, this will be looked at later
data2 <- data[ ,-11] # remove column 11 "city" as character variable

data2$condition <- as.factor(data2$condition) # make condition variable a factor
data2$if_renovated <- as.factor(data2$if_renovated) # make renovated variable a factor
data2$if_basement <- as.factor(data2$if_basement) # make basement variable a factor

```

The remaining variables and their descriptions are shown in Table 1:

```{r, Table 1, echo = FALSE}

#insert table 1
data_descriptions <- c("House sale price in thousands of US dollars", 
                       "Number of bedrooms",
                       "Number of bathrooms",
                       "Area of house in square feet",
                       "Area of whole housing lot in square feet",
                       "Number of floors in the house",
                       "Condition of house, 1 to 5",
                       "1 = if house has a basement, 0 = no basement",
                       "Year that the house was built subtracted from 2014",
                       "1 = if house has been renovated, 0 = if no renovation",
                       "Location of house to the nearest city in Washington, USA")

data_dictionary <- data.frame(names(data), data_descriptions)

kable(data_dictionary,
      col.names = c("Variable", "Description"),
      caption = "Data Dictionary")

```


## Methods:
As house price is a continuous variable I have taken a supervised learning approach and will be using regression to look at the relationship between house price and features of each house.

Review approaches tried or considered

Summary of final approach and justification of why this approach was chosen:

```{r, splitting into training and test set}

set.seed(2) 
n = nrow(data2) #number of rows
train_index = sample(1:n, size = round(0.8*n), replace=FALSE) 
train = data2[train_index ,] #takes 80% of the data for training set
test = data2[-train_index ,] #remaining 20% for the test set

```

```{r, lm using least squares}
lm_model <- lm(price ~ .-condition-if_renovated, 
               data = train)
# make predictions on test set
lm_pred <- predict(lm_model, test) 
# calculate MSE
mean((test[, "price"] - lm_pred)^2)
summary(lm_model)

```




```{r setup, include=FALSE}
#convert city variable from character to factor
data$city <- as.factor(data$city)
#obtain summary for this variable
summary(data$city)


```




## Results:

Summary of major results, graphs, diagnostic outputs

Strictly relevant to the objectives

Must include a link to the Github repository containing a fully reproducible and documented analysis
Reported in scientific style.



## Conclusions:

~1 paragraph


### Literature Cited:
3-5 peer reviewed references
-
-
-
-
-